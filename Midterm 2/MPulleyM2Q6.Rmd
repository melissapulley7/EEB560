---
title: "MPulleyM2Q6"
author: "Melissa Pulley"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

You are tasked on evaluating the growth of grass (kg of dry matter per hectare: KgDMHA). 

You want to test three models:

KgDMHA~ Water + Salinity + Nitrogen
KgDMHA~ Pests + Graze
KgDMHA~ Water + Salinity + Nitrogen + Pests + Graze

Before running the models, you wonder whether AICc will truly choose the model that best predicts the data, so, you have decided to do some model validation.

```{r}
grass=read.csv("grasslanddata.csv")
summary(grass)
```


1. Randomly split your dataset, with ~75% of the data for the training and ~25% of the data for the test

```{r}
set.seed(5)
N=length(grass$X)
test_size = 0.25*N
test_data_ind = as.numeric(sample(1:1000,test_size,replace=F))
max(test_data_ind)

test_dat = grass[test_data_ind,]
summary(test_dat)

training_dat = grass[-test_data_ind,]
summary(training_dat)
```


2) With the training dataset, run each of the three models. You should obtain an output for each model

```{r}
m1 = lm(KgDMHA~Water + Salinity + Nitrogen, data=training_dat)
m2 = lm(KgDMHA~Pests + Graze, data=training_dat)
m3 = lm(KgDMHA~Water + Salinity + Nitrogen + Pests + Graze, data=training_dat)



```


3) Obtain an AICc table for the models you ran

```{r}
library(MuMIn)
test=AICc(m1,m2,m3)
test
```


4) In the test dataset, add three new columns called predictmodel1, predictmodel2, precitmodel3. Populate the columns with the predicted values based on each of the three models you ran. You can use the coefficients, or the predict function to obtain those values.

```{r}
predictmodel1

predictmode12

predictmodel3
```


5) Use the following equation:
$$RSME = \sqrt{\dfrac{\sum_{i=1}^n(y_i-\hat{y}_i)^2}{n}}$$
And estimate RMSE for EACH of the three models.

NOTE: Do not use a built-in R function to estimate RMSE, you should estimate it using the equation. You can take many steps (e.g., creating new columns, multiple lines of code) if you need to. As a reminder y is the observed data, and Å· is the predicted value (for each model)  

6) According to the RMSE, what model is the best?

7) Compare the RMSE with the AICc and with the R-squared from the models. Do all three metrics agree on the best model?